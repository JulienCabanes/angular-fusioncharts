/*! angular-fusioncharts v.0.0.1 2013-07-09 */
!function(a){"use strict";var b=a.module("fusioncharts",[]);b.provider("fcChartFactory",function(){function b(a,b){var c=a.attr("id");return c||(c=b.id+"Id",a.attr("id",c)),c}var c=this,d=0;c.useFlash=!1,c.defaultChartType="Column3D",c.$get=["$q","$http",function(e,f){return c.FCChart=function(g,h,i,j){function k(b){return a.isString(b)?"xml":"json"}function l(a){return!a.id}g=g||c.defaultChartType,c.useFlash&&(g+=".swf"),h||(h="fcChart"+d++);var m=new FusionCharts(g,h,i,j);this.destroy=function(){m.dispose()},this.renderData=function(a,c,d){var f=b(a,m);e.when(c).then(function(a){l(m)||(m.setChartData(a,d||k(a)),m.hasRendered()||m.render(f))})},this.renderDataUrl=function(b,c,d){if(!a.isString(c))throw new Error("The dataUrl must be a string");var g=e.defer();f.get(c).success(function(a){g.resolve(a)}).error(function(a,b,c,d){g.reject("Failed to load data at: "+d.url)}),this.renderData(b,g.promise,d)}},{create:function(a,b,d,e){return new c.FCChart(a,b,d,e)}}}]}),b.directive("fcChart",["fcChartFactory","$timeout",function(b,c){return{restrict:"AE",scope:{chartId:"@fcChartId",type:"@fcChartType",width:"@width",height:"@height",data:"=fcData",dataType:"@fcDataType",dataUrl:"@fcDataUrl"},replace:!0,link:function(d,e){function f(){h||(h=c(function(){if(d.data)g.renderData(e,d.data,d.dataType);else{if(!a.isString(d.dataUrl))throw new Error("No data to get. Use the fc-data or fc-data-url attributes.");g.renderDataUrl(e,d.dataUrl,d.dataType)}h=null}))}var g,h;d.$watch("type",function(a){g&&g.destroy(),g=b.create(a,d.chartId,d.width,d.height),f()}),d.$watch("data",function(a,b){a&&a!==b&&f()}),d.$watch("dataUrl",function(a,b){a&&a!==b&&f()}),d.$on("$destroy",function(){g.destroy()})}}}])}(angular);