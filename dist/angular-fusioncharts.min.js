!function(a){var b=a.module("fusioncharts",[]);b.directive("fcChart",["fcChartFactory","$timeout",function(b,c){"use strict";return{restrict:"AE",scope:{chartId:"@fcChartId",type:"@fcChartType",width:"@width",height:"@height",data:"=fcData",dataType:"@fcDataType",dataUrl:"@fcDataUrl"},replace:!0,link:function(d,e){function f(){j||(j=c(function(){if(d.data)i.renderData(e,d.data,d.dataType);else{if(!a.isString(d.dataUrl))throw new Error("No data to get. Use the fc-data or fc-data-url attributes.");i.renderDataUrl(e,d.dataUrl,d.dataType)}j=null}))}function g(a){i&&i.destroy(),i=b.create(a,d.chartId,d.width,d.height),f()}function h(a,b){a&&a!==b&&f()}var i,j;d.$watch("type",g),d.$watch("data",h,!0),d.$watch("dataUrl",h),d.$on("$destroy",function(){i.destroy()})}}}]),b.provider("fcChartFactory",function(){"use strict";function b(a,b){var c=a.attr("id");return c||(c=b.id+"Id",a.attr("id",c)),c}var c=this,d=0;c.useFlash=!1,c.defaultChartType="Column3D",c.$get=["$q","$http",function(e,f){return c.FCChart=function(g,h,i,j){function k(b){return a.isString(b)?"xml":"json"}function l(a){return!a.id}g=g||c.defaultChartType,c.useFlash&&(g+=".swf"),h||(h="fcChart"+d++);var m=new FusionCharts(g,h,i,j);this.destroy=function(){m.dispose()},this.renderData=function(a,c,d){var f=b(a,m);e.when(c).then(function(a){l(m)||(m.setChartData(a,d||k(a)),m.hasRendered()||m.render(f))})},this.renderDataUrl=function(b,c,d){if(!a.isString(c))throw new Error("The dataUrl must be a string");var g=e.defer();f.get(c).success(function(a){g.resolve(a)}).error(function(a,b,c,d){g.reject("Failed to load data at: "+d.url)}),this.renderData(b,g.promise,d)}},{create:function(a,b,d,e){return new c.FCChart(a,b,d,e)}}}]})}(angular);